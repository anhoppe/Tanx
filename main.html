<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="playerStats.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h2>Tanx - Prepare for inner greeness</h2>

<div class="tab">
  <button class="tablinks" onclick="onTabClick(event, 'Home')">Home</button>
  <button class="tablinks" onclick="onTabClick(event, 'Tank')">Tanks</button>
  <button class="tablinks" onclick="onTabClick(event, 'Weapon')">Weapons</button>
  <button class="tablinks" onclick="onTabClick(event, 'HQ')">HQ</button>
</div>

<div id="Home" class="tabcontent">
  <h3>Home</h3>
  <div class="btn-group">
    <button class="button" id="startButton" type="button" class=btn >Start Game</button>
    <button id="quitButton" type="button" class=btn>Quit Game</button>
  </div>
</div>

<div id="Tank" class="tabcontent">
  <h3>Maintain your Tanks</h3>
  <div class="btn-group">
    <div id="tankShopImages" class="row"></div>
    <button id="buyTankButton" type="button" class=btn>Buy Tank</button>
    <button id="buyTankEquipmentButton" type="button" class=btn>Buy Equipment</button>
    <button id="monuntWeaponToTank" type="button" class=btn>Mount Weapon</button>
  </div>
</div>

<div id="Weapon" class="tabcontent">
  <h3>Your weapon systems</h3>
  <div class="btn-group">
    <div id="weaponShopImages" class="row">
    </div>
    <button id="buyWeapon" type="button" class=btn>Buy</button>
    <button id="sellWeapon" type="button" class=btn>Sell</button>
    <button id="upgradeWeapon" type="button" class=btn>Upgrade</button>
  </div>
</div>

<div id="HQ" class="tabcontent">
  <h3>Manage your HQ</h3>
  <div class="btn-group">
    <button id="buyHqEquipmentButton" type="button" class=btn>Buy Equipment</button>
  </div>
</div>

<script type="text/javascript">
  // Home
  // Button events for the sub-tabs
  document.getElementById("startButton").onclick = function () {
      location.href = "levelSelect.html"
  }

  document.getElementById("quitButton").onclick = function () {
      location.href = "index.html"
  }

  // Tank
  var tanks = PlayerStats.getAllTanksOwnedByPlayer()
  var tankIds = []

  for (var tank of tanks)
  {
    var column = document.createElement("column")
    column.setAttribute("class", "column")

    var image = document.createElement("img");
    image.setAttribute("src", tank.shopImage);
    image.setAttribute("id", tank.index);
    tankIds.push(tank.index)
    image.onclick = (event) => {
      selectedTankIndex = tankIds[event.srcElement.id]
      PlayerStats.setTankId(selectedTankIndex)
    }
    column.appendChild(image)

    var nameText = document.createElement("label")
    nameText.innerHTML = tank.name
    column.appendChild(nameText)

    document.getElementById("tankShopImages").appendChild(column)
  }

  document.getElementById("buyTankButton").onclick = function () {
        location.href = "buyTank.html"
  }
  document.getElementById("buyTankEquipmentButton").onclick = function () {
        location.href = "buy.html"
  }
  document.getElementById("monuntWeaponToTank").onclick = function () {
        location.href = "mountWeapon.html"
  }
  

  // Weapons

  // Add all weapons in player's stock to the visualization
  var weapons = PlayerStats.getAllWeaponsOwnedByPlayer()
  for (var weapon of weapons)
  {
    var image = document.createElement("img");
    image.setAttribute("src", weapon.shopImage);
    image.setAttribute("id", weapon.index)
    
    image.onclick = () => {
      var index = parseInt(event.srcElement.id)

      document.getElementById("upgradeWeapon").innerHTML = "Upgrade (" + weapons[index].type + ")"

      localStorage.selectedWeaponForUpgradeIndex = JSON.stringify(index)
    }
    
    var column = document.createElement("column")
    column.setAttribute("class", "column")
    column.appendChild(image)

    document.getElementById("weaponShopImages").appendChild(column)
  }

  document.getElementById("buyWeapon").onclick = function() {
    location.href = "weaponBuy.html"
  }
  document.getElementById("upgradeWeapon").onclick = function () {
    location.href = "weapon.html"
  }

  // HQ
  document.getElementById("buyHqEquipmentButton").onclick = function () {
        location.href = "hq.html"
  }

  // Select main tab
function onTabClick(evt, tabName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent")
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none"
  }
  tablinks = document.getElementsByClassName("tablinks")
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "")
  }
  document.getElementById(tabName).style.display = "block"
  evt.currentTarget.className += " active"
}
</script>
   
</body>
</html>
